# Configuration of the router's HTTP server
# Default configuration for container
supergraph:
  # The socket address and port to listen on
  listen: 0.0.0.0:${env.PORT:-4000}
  introspection: true

# For demo purposes - can remove or enable homepage
sandbox:
  enabled: true
homepage:
  enabled: false

cors:
  origins:
    - https://studio.apollographql.com
  allow_credentials: true

# This would make debugging easier, but should be a per subgraph basis for production
include_subgraph_errors:
  all: true # Propagate errors from all subgraphs

subscription:
  enabled: true
  mode:
    passthrough:
      # docker setup, for local setup comment out the following section
      subgraphs:
        products:
          path: /

### Enter Workshop Module Configs Below

telemetry:
  exporters:
    tracing:
      common:
        service_name: 'workshop'
        sampler: 1.0 # enable this for Studio OTEL spans
      otlp:
        enabled: true

        # Optional endpoint, either 'default' or a URL (Defaults to http://127.0.0.1:4317 for gRPC and http://127.0.0.1:4318 for HTTP)
        # endpoint: 'https://api.honeycomb.io:443'
        endpoint: 'api.honeycomb.io/v1/traces'

        # Optional protocol (Defaults to grpc)
        protocol: grpc

        # Optional Grpc configuration
        grpc:
          metadata:
            'x-honeycomb-team': '2jN8jkeozV5bHoUFTcfc1B'
            'x-honeycomb-dataset': 'workshop'

        batch_processor:
          max_export_batch_size: 512
          max_concurrent_exports: 1
          max_export_timeout: 30s
          max_queue_size: 2048
          scheduled_delay: 5s
#
#
#
# telemetry:
#   instrumentation:
#     spans:
#       mode: 'spec_compliant'
#   apollo:
#     field_level_instrumentation_sampler: 1
#     # experimental_local_field_metrics: true

#   exporters:
#     tracing:
#       common:
#         service_name: 'workshop'
#         sampler: 1.0 # enable this for Studio OTEL spans
#       otlp:
#         enabled: true
#         endpoint: 'https://api.honeycomb.io:443'
#         protocol: grpc
#         grpc:
#           metadata:
#             'x-honeycomb-team': '2jN8jkeozV5bHoUFTcfc1B'
#             'x-honeycomb-dataset': 'workshop'
# metrics:
#   common:
#     service_name: 'workshop'
#   otlp:
#     enabled: true
#     endpoint: 'https://api.honeycomb.io:443'
#     protocol: grpc
#     grpc:
#       metadata:
#         'x-honeycomb-team': '2jN8jkeozV5bHoUFTcfc1B'
#         'x-honeycomb-dataset': 'workshop'
